<!DOCTYPE html>
<html>
<head>
    <title>Experience Peer Review</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

    <link rel="stylesheet" type="text/css" href="public/stylesheet.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-app.js"></script>

    <!-- Add SDKs for Firebase products that you want to use
    https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-firestore.js"></script>
    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyBsKdNN4aBDxYXzd62lLmqqRxPi9hCRdiI",
            authDomain: "experiencepeerreview.firebaseapp.com",
            databaseURL: "https://experiencepeerreview.firebaseio.com",
            projectId: "experiencepeerreview",
            storageBucket: "experiencepeerreview.appspot.com",
            messagingSenderId: "975792372955",
            appId: "1:975792372955:web:55cff2d32ee6185b3fe0fe"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        // ref to firestore database
        var db = firebase.firestore();
    </script>

    <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css"/>

    <script>
        // Initialize the FirebaseUI Widget using Firebase.
        var ui = new firebaseui.auth.AuthUI(firebase.auth());
    </script>
    <!-- The surrounding HTML is left untouched by FirebaseUI.
         Your app may use that space for branding, controls and other customizations.-->


</head>


<div>


<!--navigation bar placeholder-->
<div id="nav-placeholder"></div>

<!--BOOTSTRAP CENTRE ITEMS-->
<div class="centerOfScreen">
            <br>
            <img src="images/BCITlogo.png" alt="" id="bcitLOGO"/>
            <div class="locationPeerReviewTitle">
                <p> PEER REVIEWS</p>
            </div>

                <label>Search</label>
                <select id="progList">
                    <option value="default">Search Programs...</option>
                </select>

                <div class="mainbutton" id="search">
                    Search Reviews
                </div>

                <div class="mainbutton" id="write">
                    Write A Review
                </div>
            </div>
            <div class="col-4"></div>
        </div>
        <div class="row">
            <div class="col-4"></div>
            <div class="col-4">
                <div class="mainbutton" id="history">
                    My Review History
                </div>
            </div>
            <div class="col-4"></div>
        </div>
    </div>
</div>


    <!-- Modal -->
    <div id="loginModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Login/Signup</h4>
                </div>
                <div class="modal-body">
                    <p>Some text in the modal.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            $("#write").click(function () {
                if (localStorage.getItem("username")) {
                    let prgm = document.getElementById("progList").value;
                    if (prgm === "default") {
                        alert("Please select a program to continue.");
                    } else {
                        window.location.href = "create_review.html?" + prgm;
                    }
                } else {
                    $("#loginModal").modal();
                }
            });
        });

        let val = document.getElementById("progList").value;
        console.log(val);

        function getPrograms() {
            var programsRef = db.collection('Programs');
            programsRef.get().then(function (querySnapshot) {
                querySnapshot.forEach(function (doc) {
                    progSelect = document.getElementById('progList');
                    progSelect.options[progSelect.options.length] = new Option(doc.data().FullName, doc.id)
                })
            });
        }

        getPrograms();

        document.getElementById("search").onclick = toSearch;
        document.getElementById("history").onclick = toHistory;

        //document.getElementById("write").onclick = toWrite;

        function toSearch() {
            let prgm = document.getElementById("progList").value;
            if (prgm === "default") {
                alert("Please select a program to continue.");
            } else {
                window.location.href = "format.html?" + prgm;
            }
        }

        function toHistory() {
            let prgm = document.getElementById("progList").value;
            if (prgm === "default") {
                alert("Please select a program to continue.");
            } else {
                window.location.href = "history.html?" + prgm;
            }
        }

        function checkBirthday() {
            if (localStorage.getItem('username')) {
                let today = new Date();
                let date = (today.getMonth() + 1) + "-" + today.getDate();
                birthday = localStorage.getItem('birthday');
                if (birthday) {
                    var userBirthday = birthday.slice(5);
                }

                if (date === userBirthday) {
                    alert("Happy Birthday!")
                }
            }
        }

        checkBirthday();
        /*function toWrite() {
            $('#loginModal').modal('show');
        }*/

        $(function () {
            $("#nav-placeholder").load("./navigation.html");
        });

    </script>
</body>
</html>
